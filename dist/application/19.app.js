(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{161:function(e,t,n){"use strict";var a=n(123),o=n(0),i=n(1),l=n(124),r=n(42),c=n(44),s=n(57),d=n(143),b=n(149),m=Object(l.a)(),u=function(e){function t(t){var n=e.call(this,t)||this;return n._toggleButton=i.createRef(),n._onClick=function(e){var t=n.props,a=t.disabled,o=t.checked,i=t.onChange,l=t.onChanged,r=t.onClick,c=n.state.checked;a||(void 0===o&&n.setState({checked:!c}),i&&i(e,!c),l&&l(!c),r&&r(e))},n._warnMutuallyExclusive({checked:"defaultChecked"}),n._warnDeprecations({onAriaLabel:"ariaLabel",offAriaLabel:void 0,onChanged:"onChange"}),n.state={checked:!(!t.checked&&!t.defaultChecked)},n._id=t.id||Object(r.c)("Toggle"),n}return o.d(t,e),Object.defineProperty(t.prototype,"checked",{get:function(){return this.state.checked},enumerable:!0,configurable:!0}),t.prototype.componentWillReceiveProps=function(e){void 0!==e.checked&&this.setState({checked:!!e.checked})},t.prototype.render=function(){var e=this,t=this.props,n=t.as,a=void 0===n?"div":n,l=t.className,r=t.theme,s=t.disabled,u=t.keytipProps,g=t.label,p=t.ariaLabel,h=t.onAriaLabel,k=t.offAriaLabel,y=t.offText,f=t.onText,E=t.styles,x=t.inlineLabel,C=this.state.checked,S=C?f:y,O=C?h:k,j=Object(c.d)(this.props,c.g,["defaultChecked"]),A=m(E,{theme:r,className:l,disabled:s,checked:C,inlineLabel:x,onOffMissing:!f&&!y});return i.createElement(a,{className:A.root,hidden:j.hidden},g&&i.createElement(d.a,{htmlFor:this._id,className:A.label},g),i.createElement("div",{className:A.container},i.createElement(b.a,{keytipProps:u,ariaDescribedBy:j["aria-describedby"],disabled:s},function(t){return i.createElement("button",o.a({},j,t,{className:A.pill,disabled:s,id:e._id,type:"button",role:"switch",ref:e._toggleButton,"aria-disabled":s,"aria-checked":C,"aria-label":p||O,"data-is-focusable":!0,onChange:e._noop,onClick:e._onClick}),i.createElement("div",{className:A.thumb}))}),S&&i.createElement(d.a,{className:A.text},S)))},t.prototype.focus=function(){this._toggleButton.current&&this._toggleButton.current.focus()},t.prototype._noop=function(){},t}(s.a),g=n(20);n.d(t,"a",function(){return p});var p=Object(a.a)(u,function(e){var t,n,a,o,i,l,r,c=e.theme,s=e.className,d=e.disabled,b=e.checked,m=e.inlineLabel,u=e.onOffMissing,p=c.semanticColors,h=p.bodyBackground,k=p.inputBackgroundChecked,y=p.inputBackgroundCheckedHovered,f=p.disabledBodySubtext,E=p.inputBorderHovered,x=p.inputForegroundChecked,C=p.disabledBodySubtext,S=p.disabledBackground,O=p.smallInputBorder,j=p.inputBorderHovered,A=p.disabledBodySubtext,v=p.disabledText;return{root:["ms-Toggle",b&&"is-checked",!d&&"is-enabled",d&&"is-disabled",c.fonts.medium,{marginBottom:"8px"},m&&{display:"flex",alignItems:"center"},s],label:["ms-Toggle-label",d&&{color:v,selectors:(t={},t[g.f]={color:"GrayText"},t)},m&&!u&&{marginRight:16},u&&m&&{order:1,marginLeft:16}],container:["ms-Toggle-innerContainer",{display:"inline-flex",position:"relative"}],pill:["ms-Toggle-background",Object(g.t)(c,-3),{fontSize:"20px",boxSizing:"border-box",width:"2.2em",height:"1em",borderRadius:"1em",transition:"all 0.1s ease",borderWidth:"1px",borderStyle:"solid",background:h,borderColor:O,cursor:"pointer",display:"flex",alignItems:"center",padding:"0 .2em"},!d&&[!b&&{selectors:{":hover":[{borderColor:j}],":hover .ms-Toggle-thumb":[{selectors:(n={},n[g.f]={borderColor:"Highlight"},n)}]}},b&&[{background:k,borderColor:"transparent",justifyContent:"flex-end"},{selectors:(a={":hover":[{backgroundColor:y,borderColor:"transparent",selectors:(o={},o[g.f]={backgroundColor:"Highlight"},o)}]},a[g.f]={backgroundColor:"WindowText"},a)}]],d&&[{cursor:"default"},!b&&[{borderColor:A}],b&&[{backgroundColor:f,borderColor:"transparent",justifyContent:"flex-end"}]],!d&&{selectors:{"&:hover":{selectors:(i={},i[g.f]={borderColor:"Highlight"},i)}}}],thumb:["ms-Toggle-thumb",{width:".5em",height:".5em",borderRadius:".5em",transition:"all 0.1s ease",backgroundColor:E,borderColor:"transparent",borderWidth:".28em",borderStyle:"solid",boxSizing:"border-box"},!d&&b&&[{backgroundColor:x,selectors:(l={},l[g.f]={backgroundColor:"Window",borderColor:"Window"},l)}],d&&[!b&&[{backgroundColor:C}],b&&[{backgroundColor:S}]]],text:["ms-Toggle-stateText",{selectors:{"&&":{padding:"0",margin:"0 8px",userSelect:"none"}}},d&&{selectors:{"&&":{color:v,selectors:(r={},r[g.f]={color:"GrayText"},r)}}}]}},void 0,{scope:"Toggle"})},320:function(e,t,n){"use strict";n.r(t),n.d(t,"SettingsPage",function(){return f}),n.d(t,"SettingInputComponent",function(){return E});var a=n(0),o=n(8),i=n(3),l=n(13),r=n(4),c=n(2),s=n(7),d=n(333),b=n(144),m=n(161),u=n(81),g=n(146),p=n(10),h=n(138),k=n(148),y=n(1);let f=class extends y.Component{constructor(){super(...arguments),this.triggerUpdate=0,this.inputEl=null,this.loading=!1}get canEdit(){return i.B.currentUser.canEditSettings}componentWillMount(){setTimeout(()=>l.bb.updateDropboxBackups(),r.t)}render(){return y.createElement("div",{className:"settings-component p-15 p-l-10 p-r-10"},y.createElement(o.l,{title:Object(i.A)("General Setting")},y.createElement(E,{element:y.createElement(d.a,{label:Object(i.A)("Language"),options:[{key:"en",text:"English"},{key:"ar",text:"العربية"}],defaultSelectedKey:l.bb.getSetting("lang"),onChange:(e,t)=>{l.bb.setSetting("lang",t.key.toString())},disabled:!this.canEdit}),info:Object(i.A)("Choose the main language of display menus and items")}),y.createElement(E,{element:y.createElement(d.a,{label:Object(i.A)("Date format"),options:[{key:"dd/mm/yyyy",text:"dd/mm/yyyy"},{key:"mm/dd/yyyy",text:"mm/dd/yyyy"},{key:"dd MM 'YY",text:"dd MM 'YY"}],defaultSelectedKey:l.bb.getSetting("date_format"),onChange:(e,t)=>{l.bb.setSetting("date_format",t.key.toString())},disabled:!this.canEdit}),info:Object(i.A)("Set the date format to be used across this application")}),y.createElement(E,{element:y.createElement(d.a,{label:Object(i.A)("Week ends on"),options:r.c.days(!0).map((e,t)=>({key:t.toString(),text:Object(i.A)(e)})),defaultSelectedKey:l.bb.getSetting("weekend_num"),onChange:(e,t)=>{l.bb.setSetting("weekend_num",t.key.toString())},disabled:!this.canEdit}),info:Object(i.A)("On which day the week ends")}),y.createElement(E,{element:y.createElement(b.a,{value:l.bb.getSetting("dropbox_accessToken"),label:Object(i.A)("Dropbox access token"),onChange:(e,t)=>{l.bb.setSetting("dropbox_accessToken",t),setTimeout(()=>i.z.validateDropBoxToken(),r.t/2)},disabled:!this.canEdit}),info:Object(i.A)("This access token is used to store files across the application, like backups and images")})),y.createElement(o.l,{title:Object(i.A)("Financial Settings")},l.bb.getSetting("time_tracking")?y.createElement(E,{element:y.createElement(b.a,{label:Object(i.A)("Time expenses (per hour)"),type:"number",value:l.bb.getSetting("hourlyRate"),onChange:(e,t)=>{l.bb.setSetting("hourlyRate",t.toString())},disabled:!this.canEdit}),info:Object(i.A)("When time tracking enabled, this is used to calculate profits and expenses, as time is also added to the expenses So here you can put the electricity, rent, and other time dependent expenses")}):"",y.createElement(E,{element:y.createElement(b.a,{label:Object(i.A)("Currency symbol"),value:l.bb.getSetting("currencySymbol"),onChange:(e,t)=>{l.bb.setSetting("currencySymbol",t.toString())},disabled:!this.canEdit}),info:Object(i.A)("This symbol you enter here will be used across your application")})),y.createElement(o.l,{title:Object(i.A)("Optional Modules and Features")},y.createElement(m.a,{onText:Object(i.A)("Prescriptions module enabled"),offText:Object(i.A)("Prescriptions module disabled"),defaultChecked:!!l.bb.getSetting("module_prescriptions"),onChange:(e,t)=>{l.bb.setSetting("module_prescriptions",t?"enable":"")},disabled:!this.canEdit}),y.createElement(m.a,{onText:Object(i.A)("Orthodontic module enabled"),offText:Object(i.A)("Orthodontic module disabled"),defaultChecked:!!l.bb.getSetting("module_orthodontics"),onChange:(e,t)=>{l.bb.setSetting("module_orthodontics",t?"enable":"")},disabled:!this.canEdit}),y.createElement(m.a,{onText:Object(i.A)("Statistics module enabled"),offText:Object(i.A)("Statistics module disabled"),defaultChecked:!!l.bb.getSetting("module_statistics"),onChange:(e,t)=>{l.bb.setSetting("module_statistics",t?"enable":"")},disabled:!this.canEdit}),y.createElement(m.a,{onText:Object(i.A)("Time tracking enabled"),offText:Object(i.A)("Time tracking disabled"),defaultChecked:!!l.bb.getSetting("time_tracking"),onChange:(e,t)=>{l.bb.setSetting("time_tracking",t?"enable":"")},disabled:!this.canEdit})),y.createElement(o.l,{title:Object(i.A)("Backup and Restore")},i.z.online?y.createElement("div",null,y.createElement(u.a,{onClick:()=>{i.i.compact()},iconProps:{iconName:"ZipFolder"},className:"m-l-5 m-t-5",text:Object(i.A)("Run compaction")}),y.createElement(u.a,{onClick:()=>{Object(i.m)()},className:"m-l-5 m-t-5",iconProps:{iconName:"Database"},text:Object(i.A)("Download a backup")}),y.createElement(u.a,{onClick:()=>this.inputEl?this.inputEl.click():"",className:"m-l-5 m-t-5",iconProps:{iconName:"DatabaseSync"},text:Object(i.A)("Restore from file")}),y.createElement("input",{ref:e=>this.inputEl=e,hidden:!0,type:"file",multiple:!1,onChange:e=>a.b(this,void 0,void 0,function*(){e.target.files&&e.target.files.length>0&&(yield i.v.fromFile(e.target.files[0]))})})):y.createElement(g.a,{messageBarType:p.a.warning},Object(i.A)("Backup and restore functionality are not available while you're offline"))),y.createElement(o.l,{title:Object(i.A)("Automated Backup and Restore")},i.z.online?i.z.dropboxActive?y.createElement("div",null,y.createElement(d.a,{label:Object(i.A)("Backup frequency"),options:[{key:"d",text:Object(i.A)("Daily")},{key:"w",text:Object(i.A)("Weekly")},{key:"m",text:Object(i.A)("Monthly")},{key:"n",text:Object(i.A)("Never")}],defaultSelectedKey:l.bb.getSetting("backup_freq"),onChange:(e,t)=>{l.bb.setSetting("backup_freq",t.key.toString())},disabled:!this.canEdit}),y.createElement(b.a,{value:l.bb.getSetting("backup_retain"),label:Object(i.A)("How many backups to retain"),onChange:(e,t)=>{l.bb.setSetting("backup_retain",t)},disabled:!this.canEdit,type:"number"}),l.bb.dropboxBackups.length?y.createElement("table",{className:"ms-table"},y.createElement("thead",null,y.createElement("tr",null,y.createElement("th",null,Object(i.A)("Backup")),y.createElement("th",null,Object(i.A)("Actions")))),y.createElement("tbody",null,l.bb.dropboxBackups.map(e=>{const t=new Date(e.client_modified);return y.createElement("tr",{key:e.id},y.createElement("td",null,y.createElement(o.j,{onRenderInitials:()=>y.createElement("div",{style:{textAlign:"center",fontSize:10}},`${t.getDate()}/${t.getMonth()+1}`),text:Object(r.j)(t,l.bb.getSetting("date_format")),subText:`${Math.round(e.size/1e3)} KB`})),y.createElement("td",null,y.createElement(h.a,{content:Object(i.A)("Delete")},y.createElement(k.a,{style:{marginRight:6},iconProps:{iconName:this.loading?"sync":"delete"},className:this.loading?"rotate":"",disabled:!this.canEdit,onClick:()=>{this.loading=!0,i.h.deleteOld(e.path_lower).then(()=>{this.loading=!1,l.bb.updateDropboxBackups()}).catch(()=>{this.loading=!1,l.bb.updateDropboxBackups()})}})),y.createElement(h.a,{content:Object(i.A)("Restore")},y.createElement(k.a,{style:{marginRight:6},iconProps:{iconName:this.loading?"sync":"DatabaseSync"},className:this.loading?"rotate":"",disabled:!this.canEdit,onClick:()=>{this.loading=!0,i.v.fromDropbox(e.path_lower).then(()=>this.loading=!1).catch(()=>this.loading=!1)}}))))}))):""):y.createElement(g.a,{messageBarType:p.a.warning},"A valid DropBox access token is required for this section"):y.createElement(g.a,{messageBarType:p.a.warning},Object(i.A)("Backup and restore functionality are not available while you're offline"))))}};a.c([c.k],f.prototype,"triggerUpdate",void 0),a.c([c.k],f.prototype,"inputEl",void 0),a.c([c.d],f.prototype,"canEdit",null),a.c([c.k],f.prototype,"loading",void 0),f=a.c([s.a],f);let E=class extends y.Component{render(){return y.createElement(o.k,{gutter:12,style:{marginBottom:20}},y.createElement(o.c,{style:{marginBottom:-15},md:12},this.props.element),y.createElement(o.c,{md:12},y.createElement(g.a,{style:{marginTop:22},messageBarType:p.a.info},this.props.info)))}};E=a.c([s.a],E)}}]);