(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{319:function(e,t,n){"use strict";n.r(t),n.d(t,"StaffPage",function(){return j});var a=n(1),i=n(7),s=n(3),m=n(9),c=n(5),r=n(2),l=n(8),o=n(287),d=n(301),b=n(291),h=n(6),p=n(295),u=n(28),E=n(297),f=n(300),C=n(296),g=n(15),O=n(294),B=n(0);let j=class extends B.Component{constructor(){super(...arguments),this.selectedId=s.y.currentLocation.split("/")[1],this.viewWhich=1}get canEdit(){return s.C.currentUser.canEditStaff}get selectedMemberIndex(){return m.fb.getIndexByID(this.selectedId)}get member(){return m.fb.list[this.selectedMemberIndex]}render(){return B.createElement("div",{className:"staff-component p-15 p-l-10 p-r-10"},B.createElement(i.m,{gutter:16},B.createElement(i.c,{lg:16},B.createElement(i.e,{maxItemsOnLoad:10,heads:[Object(s.B)("Staff Member"),Object(s.B)("Last/Next Appointment"),Object(s.B)("Contact Details")],rows:m.fb.list.map(e=>({id:e._id,searchableString:e.searchableString,cells:[{dataValue:e.name,component:B.createElement("div",null,B.createElement(i.k,{name:e.name,secondaryElement:B.createElement("span",null,e.nextAppointments.length," ",Object(s.B)("upcoming appointments")),size:3}),B.createElement("br",null),B.createElement(o.a,{content:Object(s.B)("Staff Member Details")},B.createElement(d.a,{className:"action-button",iconProps:{iconName:"DietPlanNotebook"},onClick:()=>{this.selectedId=e._id,this.viewWhich=1}})),B.createElement(o.a,{content:Object(s.B)("Level and Permission")},B.createElement(d.a,{className:"action-button",iconProps:{iconName:"Permissions"},onClick:()=>{this.selectedId=e._id,this.viewWhich=2}})),s.C.currentUser.canViewAppointments?B.createElement(o.a,{content:Object(s.B)("Upcoming Appointments")},B.createElement(d.a,{className:"action-button",iconProps:{iconName:"Calendar"},onClick:()=>{this.selectedId=e._id,this.viewWhich=3}})):"",B.createElement(o.a,{content:Object(s.B)("Delete")},B.createElement(d.a,{className:"action-button delete",iconProps:{iconName:"Trash"},onClick:()=>m.fb.deleteModal(e._id),disabled:!this.canEdit}))),className:"no-label"},{dataValue:(e.lastAppointment||e.nextAppointment||{date:0}).date,component:B.createElement("div",null,B.createElement(i.l,{text:e.lastAppointment&&e.lastAppointment.treatment?e.lastAppointment.treatment.type:"",subText:e.lastAppointment?Object(c.j)(e.lastAppointment.date,m.db.getSetting("date_format")):Object(s.B)("No last appointment"),size:3,onRenderInitials:()=>B.createElement(b.a,{iconName:"Previous"}),onClick:()=>{},initialsColor:e.lastAppointment?void 0:h.a.transparent}),B.createElement("br",null),B.createElement(i.l,{text:e.nextAppointment&&e.nextAppointment.treatment?e.nextAppointment.treatment.type:"",subText:e.nextAppointment?Object(c.j)(e.nextAppointment.date,m.db.getSetting("date_format")):Object(s.B)("No next appointment"),size:3,onRenderInitials:()=>B.createElement(b.a,{iconName:"Next"}),onClick:()=>{},initialsColor:e.nextAppointment?void 0:h.a.transparent})),className:"hidden-xs"},{dataValue:e.phone||e.email,component:B.createElement("div",null,B.createElement(i.l,{text:e.phone,subText:e.phone?Object(s.B)("Phone number"):Object(s.B)("No phone number"),size:3,onRenderInitials:()=>B.createElement(b.a,{iconName:"Phone"}),initialsColor:e.phone?h.a.teal:h.a.transparent}),B.createElement(i.l,{text:e.email,subText:e.email?Object(s.B)("Email"):Object(s.B)("No Email"),size:3,onRenderInitials:()=>B.createElement(b.a,{iconName:"Mail"}),initialsColor:e.email?h.a.teal:h.a.transparent})),className:"hidden-xs"}]})),commands:this.canEdit?[{key:"addNew",title:"Add new",name:Object(s.B)("Add new"),onClick:()=>{const e=new m.v;m.fb.list.push(e),this.selectedId=e._id,this.viewWhich=1},iconProps:{iconName:"Add"}}]:[]})),B.createElement(i.c,{lg:8},B.createElement("table",{className:"ms-table duty-table"},B.createElement("tbody",null,c.c.days(!0).map(e=>B.createElement("tr",{key:e},B.createElement("th",{className:"day-name"},Object(s.B)(e)),B.createElement("td",null,m.fb.list.filter(t=>-1!==t.onDutyDays.indexOf(e)).map(t=>B.createElement(i.k,{className:"m-b-5",size:3,key:t._id,name:t.name,secondaryElement:B.createElement("span",null,(t.weeksAppointments[e]||[]).length," ",Object(s.B)("appointments for")," ",Object(s.B)(e)),onClick:()=>{this.selectedId=t._id}}))))))))),this.member&&this.viewWhich?B.createElement(p.a,{isOpen:!!this.member,type:u.a.medium,closeButtonAriaLabel:"Close",isLightDismiss:!0,onDismiss:()=>{this.selectedId="",this.viewWhich=0},onRenderNavigation:()=>B.createElement(i.m,{className:"panel-heading"},B.createElement(i.c,{span:20},this.member.name?B.createElement(i.k,{name:this.member.name,secondaryElement:B.createElement("span",null,1===this.viewWhich?Object(s.B)("Staff Member Details"):"",2===this.viewWhich?Object(s.B)("Level and Permission"):"",3===this.viewWhich?Object(s.B)("Upcoming Appointments"):""),tertiaryText:this.member.phone,size:3}):B.createElement("p",null)),B.createElement(i.c,{span:4,className:"close"},B.createElement(d.a,{iconProps:{iconName:"cancel"},onClick:()=>{this.selectedId=""}})))},B.createElement("div",{className:"staff-editor"},1===this.viewWhich?B.createElement("div",null,B.createElement(i.n,{title:Object(s.B)("Basic Info")},B.createElement("div",{className:"staff-input"},B.createElement(E.a,{label:Object(s.B)("Name"),value:this.member.name,onChange:(e,t)=>this.member.name=t,disabled:!this.canEdit})),B.createElement("div",{className:"staff-input"},B.createElement("label",null,Object(s.B)("Days on duty")),c.c.days(!0).map((e,t)=>B.createElement(f.a,{key:e,disabled:!this.canEdit,label:c.c.daysShort()[t],checked:this.member.onDutyDays.indexOf(e)>-1,onChange:(t,n)=>{n?this.member.onDutyDays.push(e):this.member.onDutyDays.splice(this.member.onDutyDays.indexOf(e),1),this.member.triggerUpdate++}})))),B.createElement(i.n,{title:Object(s.B)("Contact Details")},B.createElement(i.m,{gutter:12},B.createElement(i.c,{sm:12},B.createElement("div",{className:"staff-input"},B.createElement(E.a,{label:Object(s.B)("Phone number"),value:this.member.phone,onChange:(e,t)=>this.member.phone=t,disabled:!this.canEdit}))),B.createElement(i.c,{sm:12},B.createElement("div",{className:"staff-input"},B.createElement(E.a,{label:Object(s.B)("Email"),value:this.member.email,onChange:(e,t)=>this.member.email=t,disabled:!this.canEdit})))))):"",2===this.viewWhich?B.createElement("div",null,this.member._id===s.C.currentUser._id?B.createElement(i.n,{title:Object(s.B)("Login PIN")},B.createElement("div",{className:"staff-input"},B.createElement(E.a,{label:Object(s.B)("Login PIN"),value:this.member.pin,onChange:(e,t)=>{Object(c.r)(t)<1e4?this.member.pin=t.toString():this.forceUpdate()},onClick:()=>{},type:"number",max:9999})),B.createElement(C.a,{messageBarType:g.a.info},Object(s.B)("Only you can edit this PIN, and it can only be 4 numbers"))):"",B.createElement(i.n,{title:Object(s.B)("Permission")},this.member._id===s.C.currentUser._id?B.createElement("div",null,B.createElement(C.a,{messageBarType:g.a.warning},Object(s.B)("You can't edit your own level and permissions")),B.createElement("br",null)):"",B.createElement(O.a,{defaultChecked:this.member.operates,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Operates on patients"),offText:Object(s.B)("Doesn't operate on patients"),onChange:(e,t)=>{this.member.operates=t}}),B.createElement(O.a,{defaultChecked:this.member.canViewStaff,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can view staff page"),offText:Object(s.B)("Can not view staff page"),onChange:(e,t)=>{this.member.canViewStaff=t}}),B.createElement(O.a,{defaultChecked:this.member.canViewPatients,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can view patients page"),offText:Object(s.B)("Can not view patients page"),onChange:(e,t)=>{this.member.canViewPatients=t}}),m.db.getSetting("module_orthodontics")?B.createElement(O.a,{defaultChecked:this.member.canViewOrtho,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can view orthodontics page"),offText:Object(s.B)("Can not view orthodontics page"),onChange:(e,t)=>{this.member.canViewOrtho=t}}):"",B.createElement(O.a,{defaultChecked:this.member.canViewAppointments,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can view appointments page"),offText:Object(s.B)("Can not view appointments page"),onChange:(e,t)=>{this.member.canViewAppointments=t}}),B.createElement(O.a,{defaultChecked:this.member.canViewTreatments,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can view treatments page"),offText:Object(s.B)("Can not view treatments page"),onChange:(e,t)=>{this.member.canViewTreatments=t}}),m.db.getSetting("module_prescriptions")?B.createElement(O.a,{defaultChecked:this.member.canViewPrescriptions,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can view prescriptions page"),offText:Object(s.B)("Can not view prescriptions page"),onChange:(e,t)=>{this.member.canViewPrescriptions=t}}):"",m.db.getSetting("module_statistics")?B.createElement(O.a,{defaultChecked:this.member.canViewStats,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can view statistics page"),offText:Object(s.B)("Can not view statistics page"),onChange:(e,t)=>{this.member.canViewStats=t}}):"",B.createElement(O.a,{defaultChecked:this.member.canViewSettings,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can view settings page"),offText:Object(s.B)("Can not view settings page"),onChange:(e,t)=>{this.member.canViewSettings=t}}),this.member.canViewStaff?B.createElement(O.a,{defaultChecked:this.member.canEditStaff,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can edit staff page"),offText:Object(s.B)("Can not edit staff page"),onChange:(e,t)=>{this.member.canEditStaff=t}}):"",this.member.canViewPatients?B.createElement(O.a,{defaultChecked:this.member.canEditPatients,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can edit patients page"),offText:Object(s.B)("Can not edit patients page"),onChange:(e,t)=>{this.member.canEditPatients=t}}):"",m.db.getSetting("module_orthodontics")&&this.member.canViewOrtho?B.createElement(O.a,{defaultChecked:this.member.canEditOrtho,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can edit orthodontics page"),offText:Object(s.B)("Can not edit orthodontics page"),onChange:(e,t)=>{this.member.canEditOrtho=t}}):"",this.member.canViewAppointments?B.createElement(O.a,{defaultChecked:this.member.canEditAppointments,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can edit appointments page"),offText:Object(s.B)("Can not edit appointments page"),onChange:(e,t)=>{this.member.canEditAppointments=t}}):"",this.member.canViewTreatments?B.createElement(O.a,{defaultChecked:this.member.canEditTreatments,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can edit treatments page"),offText:Object(s.B)("Can not edit treatments page"),onChange:(e,t)=>{this.member.canEditTreatments=t}}):"",m.db.getSetting("module_prescriptions")&&this.member.canViewPrescriptions?B.createElement(O.a,{defaultChecked:this.member.canEditPrescriptions,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can edit prescriptions page"),offText:Object(s.B)("Can not edit prescriptions page"),onChange:(e,t)=>{this.member.canEditPrescriptions=t}}):"",this.member.canViewSettings?B.createElement(O.a,{defaultChecked:this.member.canEditSettings,disabled:this.member._id===s.C.currentUser._id,onText:Object(s.B)("Can edit settings page"),offText:Object(s.B)("Can not edit settings page"),onChange:(e,t)=>{this.member.canEditSettings=t}}):"")):"",3===this.viewWhich?B.createElement(i.n,{title:Object(s.B)("Upcoming Appointments")},this.member.nextAppointments.length?B.createElement(m.c,{list:this.member.nextAppointments}):B.createElement(C.a,{messageBarType:g.a.info},Object(s.B)("There are no upcoming appointments for this staff member"))):"")):"")}};a.c([r.k],j.prototype,"selectedId",void 0),a.c([r.k],j.prototype,"viewWhich",void 0),a.c([r.d],j.prototype,"canEdit",null),a.c([r.d],j.prototype,"selectedMemberIndex",null),a.c([r.d],j.prototype,"member",null),j=a.c([l.a],j)}}]);