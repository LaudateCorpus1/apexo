(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{172:function(e,t,n){"use strict";n.r(t),n.d(t,"SettingsPage",function(){return E}),n.d(t,"SettingInputComponent",function(){return B});var a=n(1),i=n(5),l=n(2),o=n(4),c=n(6),s=n(3),r=n(8),d=n(45),m=n(18),b=n(15),g=n(52),u=n(41),p=n(14),h=n(16),k=n(13),y=n(0);let E=class extends y.Component{constructor(){super(...arguments),this.triggerUpdate=0,this.inputEl=null,this.loading=!1}get canEdit(){return l.C.currentUser.canEditSettings}componentWillMount(){setTimeout(()=>o.kb.updateDropboxBackups(),c.t)}render(){return y.createElement("div",{className:"settings-component p-15 p-l-10 p-r-10"},y.createElement(i.n,{title:Object(l.B)("General Setting")},y.createElement(B,{element:y.createElement(d.a,{label:Object(l.B)("Language"),options:[{key:"en",text:"English"},{key:"ar",text:"العربية"}],defaultSelectedKey:o.kb.getSetting("lang"),onChange:(e,t)=>{o.kb.setSetting("lang",t.key.toString())},disabled:!this.canEdit}),info:Object(l.B)("Choose the main language of display menus and items")}),y.createElement(B,{element:y.createElement(d.a,{label:Object(l.B)("Date format"),options:[{key:"dd/mm/yyyy",text:"dd/mm/yyyy"},{key:"mm/dd/yyyy",text:"mm/dd/yyyy"},{key:"dd MM 'YY",text:"dd MM 'YY"}],defaultSelectedKey:o.kb.getSetting("date_format"),onChange:(e,t)=>{o.kb.setSetting("date_format",t.key.toString())},disabled:!this.canEdit}),info:Object(l.B)("Set the date format to be used across this application")}),y.createElement(B,{element:y.createElement(d.a,{label:Object(l.B)("Week ends on"),options:c.c.days(!0).map((e,t)=>({key:t.toString(),text:Object(l.B)(e)})),defaultSelectedKey:o.kb.getSetting("weekend_num"),onChange:(e,t)=>{o.kb.setSetting("weekend_num",t.key.toString())},disabled:!this.canEdit}),info:Object(l.B)("On which day the week ends")}),y.createElement(B,{element:y.createElement(m.a,{value:o.kb.getSetting("dropbox_accessToken"),label:Object(l.B)("Dropbox access token"),onChange:(e,t)=>{o.kb.setSetting("dropbox_accessToken",t),setTimeout(()=>l.A.validateDropBoxToken(),c.t/2)},disabled:!this.canEdit}),info:Object(l.B)("This access token is used to store files across the application, like backups and images")})),y.createElement(i.n,{title:Object(l.B)("Financial Settings")},o.kb.getSetting("time_tracking")?y.createElement(B,{element:y.createElement(m.a,{label:Object(l.B)("Time expenses (per hour)"),type:"number",value:o.kb.getSetting("hourlyRate"),onChange:(e,t)=>{o.kb.setSetting("hourlyRate",t.toString())},disabled:!this.canEdit}),info:Object(l.B)("When time tracking enabled, this is used to calculate profits and expenses, as time is also added to the expenses So here you can put the electricity, rent, and other time dependent expenses")}):"",y.createElement(B,{element:y.createElement(m.a,{label:Object(l.B)("Currency symbol"),value:o.kb.getSetting("currencySymbol"),onChange:(e,t)=>{o.kb.setSetting("currencySymbol",t.toString())},disabled:!this.canEdit}),info:Object(l.B)("This symbol you enter here will be used across your application")})),y.createElement(i.n,{title:Object(l.B)("Optional Modules and Features")},y.createElement(b.a,{onText:Object(l.B)("Prescriptions module enabled"),offText:Object(l.B)("Prescriptions module disabled"),defaultChecked:!!o.kb.getSetting("module_prescriptions"),onChange:(e,t)=>{o.kb.setSetting("module_prescriptions",t?"enable":"")},disabled:!this.canEdit}),y.createElement(b.a,{onText:Object(l.B)("Orthodontic module enabled"),offText:Object(l.B)("Orthodontic module disabled"),defaultChecked:!!o.kb.getSetting("module_orthodontics"),onChange:(e,t)=>{o.kb.setSetting("module_orthodontics",t?"enable":"")},disabled:!this.canEdit}),y.createElement(b.a,{onText:Object(l.B)("Statistics module enabled"),offText:Object(l.B)("Statistics module disabled"),defaultChecked:!!o.kb.getSetting("module_statistics"),onChange:(e,t)=>{o.kb.setSetting("module_statistics",t?"enable":"")},disabled:!this.canEdit}),y.createElement(b.a,{onText:Object(l.B)("Time tracking enabled"),offText:Object(l.B)("Time tracking disabled"),defaultChecked:!!o.kb.getSetting("time_tracking"),onChange:(e,t)=>{o.kb.setSetting("time_tracking",t?"enable":"")},disabled:!this.canEdit})),y.createElement(i.n,{title:Object(l.B)("Backup and Restore")},l.A.online?y.createElement("div",null,y.createElement(g.a,{onClick:()=>{l.i.compact()},iconProps:{iconName:"ZipFolder"},className:"m-l-5 m-t-5",text:Object(l.B)("Run compaction")}),y.createElement(g.a,{onClick:()=>{Object(l.m)()},className:"m-l-5 m-t-5",iconProps:{iconName:"Database"},text:Object(l.B)("Download a backup")}),y.createElement(g.a,{onClick:()=>this.inputEl?this.inputEl.click():"",className:"m-l-5 m-t-5",iconProps:{iconName:"DatabaseSync"},text:Object(l.B)("Restore from file")}),y.createElement("input",{ref:e=>this.inputEl=e,hidden:!0,type:"file",multiple:!1,onChange:e=>a.b(this,void 0,void 0,function*(){e.target.files&&e.target.files.length>0&&(yield l.w.fromFile(e.target.files[0]))})})):y.createElement(u.a,{messageBarType:p.a.warning},Object(l.B)("Backup and restore functionality are not available while you're offline"))),y.createElement(i.n,{title:Object(l.B)("Automated Backup and Restore")},l.A.online?l.A.dropboxActive?y.createElement("div",null,y.createElement(d.a,{label:Object(l.B)("Backup frequency"),options:[{key:"d",text:Object(l.B)("Daily")},{key:"w",text:Object(l.B)("Weekly")},{key:"m",text:Object(l.B)("Monthly")},{key:"n",text:Object(l.B)("Never")}],defaultSelectedKey:o.kb.getSetting("backup_freq"),onChange:(e,t)=>{o.kb.setSetting("backup_freq",t.key.toString())},disabled:!this.canEdit}),y.createElement(m.a,{value:o.kb.getSetting("backup_retain"),label:Object(l.B)("How many backups to retain"),onChange:(e,t)=>{o.kb.setSetting("backup_retain",t)},disabled:!this.canEdit,type:"number"}),o.kb.dropboxBackups.length?y.createElement("table",{className:"ms-table"},y.createElement("thead",null,y.createElement("tr",null,y.createElement("th",null,Object(l.B)("Backup")),y.createElement("th",null,Object(l.B)("Actions")))),y.createElement("tbody",null,o.kb.dropboxBackups.map(e=>{const t=new Date(e.client_modified);return y.createElement("tr",{key:e.id},y.createElement("td",null,y.createElement(i.l,{onRenderInitials:()=>y.createElement("div",{style:{textAlign:"center",fontSize:10}},`${t.getDate()}/${t.getMonth()+1}`),text:Object(c.j)(t,o.kb.getSetting("date_format")),subText:`${Math.round(e.size/1e3)} KB`})),y.createElement("td",null,y.createElement(h.a,{content:Object(l.B)("Delete")},y.createElement(k.a,{style:{marginRight:6},iconProps:{iconName:this.loading?"sync":"delete"},className:this.loading?"rotate":"",disabled:!this.canEdit,onClick:()=>{this.loading=!0,l.h.deleteOld(e.path_lower).then(()=>{this.loading=!1,o.kb.updateDropboxBackups()}).catch(()=>{this.loading=!1,o.kb.updateDropboxBackups()})}})),y.createElement(h.a,{content:Object(l.B)("Restore")},y.createElement(k.a,{style:{marginRight:6},iconProps:{iconName:this.loading?"sync":"DatabaseSync"},className:this.loading?"rotate":"",disabled:!this.canEdit,onClick:()=>{this.loading=!0,l.w.fromDropbox(e.path_lower).then(()=>this.loading=!1).catch(()=>this.loading=!1)}}))))}))):""):y.createElement(u.a,{messageBarType:p.a.warning},"A valid DropBox access token is required for this section"):y.createElement(u.a,{messageBarType:p.a.warning},Object(l.B)("Backup and restore functionality are not available while you're offline"))))}};a.c([s.k],E.prototype,"triggerUpdate",void 0),a.c([s.k],E.prototype,"inputEl",void 0),a.c([s.d],E.prototype,"canEdit",null),a.c([s.k],E.prototype,"loading",void 0),E=a.c([r.a],E);let B=class extends y.Component{render(){return y.createElement(i.m,{gutter:12,style:{marginBottom:20}},y.createElement(i.c,{style:{marginBottom:-15},md:12},this.props.element),y.createElement(i.c,{md:12},y.createElement(u.a,{style:{marginTop:22},messageBarType:p.a.info},this.props.info)))}};B=a.c([r.a],B)}}]);