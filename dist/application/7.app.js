(window.webpackJsonp=window.webpackJsonp||[]).push([[7,17,28],{161:function(e,t,n){"use strict";var i=n(123),a=n(0),o=n(1),r=n(124),s=n(42),p=n(44),l=n(57),m=n(143),c=n(149),d=Object(r.a)(),h=function(e){function t(t){var n=e.call(this,t)||this;return n._toggleButton=o.createRef(),n._onClick=function(e){var t=n.props,i=t.disabled,a=t.checked,o=t.onChange,r=t.onChanged,s=t.onClick,p=n.state.checked;i||(void 0===a&&n.setState({checked:!p}),o&&o(e,!p),r&&r(!p),s&&s(e))},n._warnMutuallyExclusive({checked:"defaultChecked"}),n._warnDeprecations({onAriaLabel:"ariaLabel",offAriaLabel:void 0,onChanged:"onChange"}),n.state={checked:!(!t.checked&&!t.defaultChecked)},n._id=t.id||Object(s.c)("Toggle"),n}return a.d(t,e),Object.defineProperty(t.prototype,"checked",{get:function(){return this.state.checked},enumerable:!0,configurable:!0}),t.prototype.componentWillReceiveProps=function(e){void 0!==e.checked&&this.setState({checked:!!e.checked})},t.prototype.render=function(){var e=this,t=this.props,n=t.as,i=void 0===n?"div":n,r=t.className,s=t.theme,l=t.disabled,h=t.keytipProps,u=t.label,b=t.ariaLabel,g=t.onAriaLabel,E=t.offAriaLabel,f=t.offText,y=t.onText,k=t.styles,C=t.inlineLabel,O=this.state.checked,v=O?y:f,x=O?g:E,N=Object(p.d)(this.props,p.g,["defaultChecked"]),j=d(k,{theme:s,className:r,disabled:l,checked:O,inlineLabel:C,onOffMissing:!y&&!f});return o.createElement(i,{className:j.root,hidden:N.hidden},u&&o.createElement(m.a,{htmlFor:this._id,className:j.label},u),o.createElement("div",{className:j.container},o.createElement(c.a,{keytipProps:h,ariaDescribedBy:N["aria-describedby"],disabled:l},function(t){return o.createElement("button",a.a({},N,t,{className:j.pill,disabled:l,id:e._id,type:"button",role:"switch",ref:e._toggleButton,"aria-disabled":l,"aria-checked":O,"aria-label":b||x,"data-is-focusable":!0,onChange:e._noop,onClick:e._onClick}),o.createElement("div",{className:j.thumb}))}),v&&o.createElement(m.a,{className:j.text},v)))},t.prototype.focus=function(){this._toggleButton.current&&this._toggleButton.current.focus()},t.prototype._noop=function(){},t}(l.a),u=n(20);n.d(t,"a",function(){return b});var b=Object(i.a)(h,function(e){var t,n,i,a,o,r,s,p=e.theme,l=e.className,m=e.disabled,c=e.checked,d=e.inlineLabel,h=e.onOffMissing,b=p.semanticColors,g=b.bodyBackground,E=b.inputBackgroundChecked,f=b.inputBackgroundCheckedHovered,y=b.disabledBodySubtext,k=b.inputBorderHovered,C=b.inputForegroundChecked,O=b.disabledBodySubtext,v=b.disabledBackground,x=b.smallInputBorder,N=b.inputBorderHovered,j=b.disabledBodySubtext,S=b.disabledText;return{root:["ms-Toggle",c&&"is-checked",!m&&"is-enabled",m&&"is-disabled",p.fonts.medium,{marginBottom:"8px"},d&&{display:"flex",alignItems:"center"},l],label:["ms-Toggle-label",m&&{color:S,selectors:(t={},t[u.f]={color:"GrayText"},t)},d&&!h&&{marginRight:16},h&&d&&{order:1,marginLeft:16}],container:["ms-Toggle-innerContainer",{display:"inline-flex",position:"relative"}],pill:["ms-Toggle-background",Object(u.t)(p,-3),{fontSize:"20px",boxSizing:"border-box",width:"2.2em",height:"1em",borderRadius:"1em",transition:"all 0.1s ease",borderWidth:"1px",borderStyle:"solid",background:g,borderColor:x,cursor:"pointer",display:"flex",alignItems:"center",padding:"0 .2em"},!m&&[!c&&{selectors:{":hover":[{borderColor:N}],":hover .ms-Toggle-thumb":[{selectors:(n={},n[u.f]={borderColor:"Highlight"},n)}]}},c&&[{background:E,borderColor:"transparent",justifyContent:"flex-end"},{selectors:(i={":hover":[{backgroundColor:f,borderColor:"transparent",selectors:(a={},a[u.f]={backgroundColor:"Highlight"},a)}]},i[u.f]={backgroundColor:"WindowText"},i)}]],m&&[{cursor:"default"},!c&&[{borderColor:j}],c&&[{backgroundColor:y,borderColor:"transparent",justifyContent:"flex-end"}]],!m&&{selectors:{"&:hover":{selectors:(o={},o[u.f]={borderColor:"Highlight"},o)}}}],thumb:["ms-Toggle-thumb",{width:".5em",height:".5em",borderRadius:".5em",transition:"all 0.1s ease",backgroundColor:k,borderColor:"transparent",borderWidth:".28em",borderStyle:"solid",boxSizing:"border-box"},!m&&c&&[{backgroundColor:C,selectors:(r={},r[u.f]={backgroundColor:"Window",borderColor:"Window"},r)}],m&&[!c&&[{backgroundColor:O}],c&&[{backgroundColor:v}]]],text:["ms-Toggle-stateText",{selectors:{"&&":{padding:"0",margin:"0 8px",userSelect:"none"}}},m&&{selectors:{"&&":{color:S,selectors:(s={},s[u.f]={color:"GrayText"},s)}}}]}},void 0,{scope:"Toggle"})},166:function(e,t,n){"use strict";n.r(t),n.d(t,"AppointmentEditorPanel",function(){return v});var i=n(0),a=n(8),o=n(3),r=n(13),s=n(4),p=n(2),l=n(7),m=n(147),c=n(19),d=n(148),h=n(331),u=n(143),b=n(333),g=n(303),E=n(144),f=n(141),y=n(81),k=n(135),C=n(161),O=n(1);let v=class extends O.Component{constructor(){super(...arguments),this.timerInputs=[],this.timeComb={hours:this.calcTime.hours,minutes:this.calcTime.minutes,am:this.calcTime.am}}get calcTime(){if(!this.props.appointment)return{hours:12,minutes:"00",am:!1};const e=new Date(this.props.appointment.date).toLocaleTimeString("en-US");return{hours:Number(e.split(":")[0]),minutes:Number(e.split(":")[1])<30?"00":"30",am:"am"===e.replace(/[^A-Z]/gi,"").toLowerCase()}}get otherAppointmentsNumber(){const e=this.props.appointment;return e?r.z.appointmentsForDay(e.date,0,0).filter(t=>t._id!==e._id).length:[].length-1}get treatmentOptions(){const e=JSON.parse(JSON.stringify(r.jb.list));if(this.props.appointment&&this.props.appointment.treatmentID.indexOf("|")>-1){const t=this.props.appointment.treatmentID.split("|"),n=this.props.appointment.treatmentID,i=t[0],a=Object(s.r)(t[1]);e.push(new r.w({_id:n,expenses:a,type:i}))}return e}get canEdit(){return o.B.currentUser.canEditAppointments}setTimeFromCombination(){if(!this.props.appointment)return;12===this.timeComb.hours&&(this.timeComb.am=!0);const e=new Date(this.props.appointment.date);e.setHours(this.timeComb.am?this.timeComb.hours:this.timeComb.hours+12,Number(this.timeComb.minutes),0,0),this.props.appointment.date=e.getTime(),this.forceUpdate()}render(){return this.props.appointment?O.createElement(m.a,{isOpen:!!this.props.appointment,type:c.a.medium,closeButtonAriaLabel:"Close",isLightDismiss:!0,onDismiss:this.props.onDismiss,onRenderNavigation:()=>O.createElement(a.k,{className:"panel-heading"},O.createElement(a.c,{span:22},O.createElement(a.i,{secondaryElement:O.createElement("span",null,Object(s.j)(this.props.appointment.date,r.bb.getSetting("date_format"))," ","/"," ",this.props.appointment&&this.props.appointment.treatment?this.props.appointment.treatment.type:""),name:(this.props.appointment.patient||{name:""}).name,size:3})),O.createElement(a.c,{span:2,className:"close"},O.createElement(d.a,{iconProps:{iconName:"cancel"},onClick:()=>{this.props.onDismiss()}})))},O.createElement("div",{className:"appointment-editor"},O.createElement(a.l,{title:Object(o.A)("Appointment")},O.createElement(a.k,{gutter:12},O.createElement(a.c,{sm:12},O.createElement("div",{className:"appointment-input date"},O.createElement(h.a,{label:Object(o.A)("Date"),disabled:!this.canEdit,className:"appointment-date",placeholder:Object(o.A)("Select a date"),value:new Date(this.props.appointment.date),onSelectDate:e=>{e&&this.props.appointment.setDate(e.getTime())},formatDate:e=>Object(s.j)(e||0,r.bb.getSetting("date_format"))}),O.createElement("p",{className:"insight"},Object(o.A)("With")," ",O.createElement("span",{className:"num-"+this.otherAppointmentsNumber},this.otherAppointmentsNumber)," ",Object(o.A)("other appointment")))),O.createElement(a.c,{sm:12},O.createElement("div",{className:"appointment-input time"},O.createElement(a.k,{gutter:12},O.createElement(u.a,null,Object(o.A)("Time")),O.createElement(a.k,{gutter:0},O.createElement(a.c,{span:8},O.createElement(b.a,{options:[12,1,2,3,4,5,6,7,8,9,10,11].map(e=>({key:e.toString(),text:e<10?`0${e.toString()}`:e.toString()})),selectedKey:this.calcTime.hours.toString(),onChange:(e,t)=>{t&&(this.timeComb.hours=Number(t.key.toString()),this.setTimeFromCombination())}})),O.createElement(a.c,{span:8},O.createElement(b.a,{options:["00","30"].map(e=>({key:e,text:e})),selectedKey:this.calcTime.minutes,onChange:(e,t)=>{t&&(this.timeComb.minutes=t.key.toString(),this.setTimeFromCombination())}})),O.createElement(a.c,{span:8},O.createElement(b.a,{options:[{text:"am",key:"am"},{text:"pm",key:"pm"}],selectedKey:this.calcTime.am?"am":"pm",onChange:(e,t)=>{t&&(this.timeComb.am="am"===t.key.toString(),this.setTimeFromCombination())}}))))))),O.createElement("div",{className:"appointment-input date"},O.createElement("label",null,Object(o.A)("Operating staff")," "),r.db.list.filter(e=>e.operates).map(e=>{const t=this.props.appointment.staffID.indexOf(e._id)>-1;return O.createElement(g.a,{key:e._id,label:e.name,disabled:!this.canEdit||!t&&-1===e.onDutyDays.indexOf(new Date(this.props.appointment.date).toLocaleDateString("en-us",{weekday:"long"})),checked:t,onChange:(t,n)=>{n?this.props.appointment.staffID.push(e._id):this.props.appointment.staffID.splice(this.props.appointment.staffID.indexOf(e._id),1),this.props.appointment.triggerUpdate++}})}))),O.createElement(a.l,{title:Object(o.A)("Case Details")},O.createElement(E.a,{multiline:!0,disabled:!this.canEdit,label:Object(o.A)("Details"),value:this.props.appointment.notes,onChange:(e,t)=>{this.props.appointment.notes=t}}),O.createElement("br",null),O.createElement(a.k,{gutter:12},O.createElement(a.c,{sm:12},O.createElement("div",{className:"appointment-input treatment"},O.createElement(b.a,{label:Object(o.A)("Treatment"),disabled:!this.canEdit,className:"treatment-type",selectedKey:this.props.appointment.treatmentID,options:this.treatmentOptions.sort((e,t)=>e.type.localeCompare(t.type)).map(e=>({key:e._id,text:e.type})),onChange:(e,t)=>{this.props.appointment.treatmentID=t.key.toString()}}))),O.createElement(a.c,{sm:12},O.createElement("div",{className:"appointment-input units-number"},O.createElement(E.a,{label:Object(o.A)("Units number"),disabled:!this.canEdit,type:"number",value:this.props.appointment.units.toString(),onChange:(e,t)=>{this.props.appointment.units=Object(s.r)(t)}}))),O.createElement(a.c,{span:24}," ",O.createElement("div",{className:"appointment-input involved-teeth"},O.createElement(a.n,{disabled:!this.canEdit,placeholder:Object(o.A)("Involved teeth"),value:this.props.appointment.involvedTeeth.map(e=>({key:e.toString(),text:e.toString()})),strict:!0,options:r.h.map(e=>({key:e.toString(),text:e.toString()})),formatText:e=>`${e.toString()} - ${Object(s.b)(Object(s.r)(e)).Palmer}`,onChange:e=>{this.props.appointment.involvedTeeth=e.map(e=>Object(s.r)(e.key))}})))),r.bb.getSetting("module_prescriptions")?O.createElement("div",null,O.createElement("hr",{className:"appointment-hr"}),O.createElement("div",{className:"appointment-input prescription"},O.createElement(a.n,{disabled:!this.canEdit,className:"prescription",value:this.props.appointment.prescriptions.map(e=>({key:e.id,text:e.prescription})),options:r.Q.list.map(this.prescriptionToTagInput),onChange:e=>{this.props.appointment.prescriptions=e.map(e=>({id:e.key,prescription:e.text}))},strict:!0,placeholder:Object(o.A)("Prescription")})),O.createElement("div",{id:"prescription-items"},O.createElement("div",{className:"print-heading"},O.createElement("h2",null,o.B.currentUser.name),O.createElement("hr",null),O.createElement("h3",null,"Patient:"," ",(this.props.appointment.patient||new r.l).name),O.createElement(a.k,null,O.createElement(a.c,{span:12},O.createElement("h4",null,"Age:"," ",(this.props.appointment.patient||new r.l).age)),O.createElement(a.c,{span:12},O.createElement("h4",null,"Gender:"," ",(this.props.appointment.patient||new r.l).gender?"Female":"Male"))),O.createElement("hr",null)),this.props.appointment.prescriptions.map(e=>O.createElement(a.k,{key:e.id},O.createElement(a.c,{span:20,className:"m-b-5"},O.createElement(a.j,{text:e.prescription.split(":")[0],onRenderInitials:()=>O.createElement(f.a,{iconName:"pill"}),subText:e.prescription.split(":")[1]})),O.createElement(a.c,{span:4,style:{textAlign:"right"}},this.canEdit?O.createElement(d.a,{iconProps:{iconName:"delete"},onClick:()=>{this.props.appointment.prescriptions=this.props.appointment.prescriptions.filter(t=>t.id!==e.id)}}):"")))),this.props.appointment.prescriptions.length?O.createElement(y.a,{onClick:print,iconProps:{iconName:"print"},text:Object(o.A)("Print prescription")}):""):""),O.createElement(a.l,{title:Object(o.A)("Expenses & Price")},O.createElement(a.k,{gutter:12},O.createElement(a.c,{sm:16},r.bb.getSetting("time_tracking")?O.createElement("div",{className:"appointment-input time"},O.createElement("label",null,Object(o.A)("Time (hours, minutes, seconds)")),O.createElement(E.a,{className:"time-input hours",type:"number",disabled:!this.canEdit,value:this.formatMillisecondsToTime(this.props.appointment.time).hours,onChange:(e,t)=>{this.timerInputs[0]=Object(s.r)(t),this.manuallyUpdateTime()}}),O.createElement(E.a,{className:"time-input minutes",type:"number",disabled:!this.canEdit,value:this.formatMillisecondsToTime(this.props.appointment.time).minutes,onChange:(e,t)=>{this.timerInputs[1]=Object(s.r)(t),this.manuallyUpdateTime()}}),O.createElement(E.a,{className:"time-input seconds",type:"number",disabled:!this.canEdit,value:this.formatMillisecondsToTime(this.props.appointment.time).seconds,onChange:(e,t)=>{this.timerInputs[2]=Object(s.r)(t),this.manuallyUpdateTime()}}),this.props.appointment.timer?O.createElement(k.a,{iconProps:{iconName:"Timer"},disabled:!this.canEdit,className:"appendage stop",text:Object(o.A)("Stop"),onClick:()=>{const e=this.props.appointment.timer;e&&clearInterval(e),this.props.appointment.timer=null}}):O.createElement(k.a,{iconProps:{iconName:"Timer"},disabled:!this.canEdit,className:"appendage",text:Object(o.A)("Start"),onClick:()=>{const e=r.z.getIndexByID(this.props.appointment._id),t=r.z.list[e];this.props.appointment.timer=window.setInterval(()=>{t.time=t.time+1e3},1e3)}}),O.createElement("p",{className:"payment-insight"},O.createElement(a.m,{text:Object(o.A)("Time value")+": "+r.bb.getSetting("currencySymbol")+Object(s.s)(this.props.appointment.spentTimeValue).toString(),type:a.o.info}),O.createElement("br",null),O.createElement(a.m,{text:Object(o.A)("Expenses")+": "+r.bb.getSetting("currencySymbol")+Object(s.s)(this.props.appointment.expenses).toString(),type:a.o.info}))):""),O.createElement(a.c,{sm:24},O.createElement("div",{className:"appointment-input paid"},O.createElement(a.k,{gutter:12},O.createElement(a.c,{sm:8},O.createElement(E.a,{type:"number",disabled:!this.canEdit,label:Object(o.A)("Price"),value:this.props.appointment.finalPrice.toString(),onChange:(e,t)=>{this.props.appointment.finalPrice=Object(s.r)(t)},prefix:r.bb.getSetting("currencySymbol")})),O.createElement(a.c,{sm:8},O.createElement(E.a,{type:"number",disabled:!this.canEdit,label:Object(o.A)("Paid"),value:this.props.appointment.paidAmount.toString(),onChange:(e,t)=>{this.props.appointment.paidAmount=Object(s.r)(t)},prefix:r.bb.getSetting("currencySymbol")})),O.createElement(a.c,{sm:8},O.createElement(E.a,{type:"number",disabled:!0,label:this.props.appointment.outstandingAmount?Object(o.A)("Outstanding"):this.props.appointment.overpaidAmount?Object(o.A)("Overpaid"):Object(o.A)("Outstanding"),value:this.props.appointment.outstandingAmount?this.props.appointment.outstandingAmount.toString():this.props.appointment.overpaidAmount?this.props.appointment.overpaidAmount.toString():this.props.appointment.outstandingAmount.toString(),prefix:r.bb.getSetting("currencySymbol")}))),O.createElement("p",{className:"payment-insight"},O.createElement(a.m,{text:Object(o.A)("Profit")+": "+r.bb.getSetting("currencySymbol")+Object(s.s)(this.props.appointment.profit).toString(),type:a.o.success}),O.createElement("br",null),O.createElement(a.m,{text:Object(o.A)("Profit percentage")+": "+Object(s.s)(100*this.props.appointment.profitPercentage).toString()+"%",type:a.o.success}))))),O.createElement(a.k,{gutter:12},O.createElement(a.c,{sm:24},O.createElement(C.a,{defaultChecked:this.props.appointment.isDone,onText:Object(o.A)("Done"),offText:Object(o.A)("Not done"),disabled:!this.canEdit,onChange:(e,t)=>{this.props.appointment.isDone=t}})))),O.createElement("br",null),this.canEdit?O.createElement(k.a,{className:"delete",iconProps:{iconName:"delete"},text:Object(o.A)("Delete"),onClick:()=>{const e=this.props.appointment;r.z.deleteModal(e._id),this.props.onDelete()}}):"",O.createElement("br",null),O.createElement("br",null),O.createElement("br",null))):O.createElement("div",null)}formatMillisecondsToTime(e){const t=Math.floor(e/36e5),n=Math.floor(e%36e5/6e4),i=Math.floor(e%36e5%6e4/1e3);return{hours:a(t),minutes:a(n),seconds:a(i)};function a(e){return e>9?e.toString():"0"+e.toString()}}manuallyUpdateTime(){const e=this.timerInputs[0],t=this.timerInputs[1],n=this.timerInputs[2];isNaN(e)||isNaN(t)||isNaN(n)||(this.props.appointment.time=36e5*e+6e4*t+1e3*n)}prescriptionToTagInput(e){return{key:e._id,text:`${e.name}: ${e.doseInMg}${Object(o.A)("mg")} ${e.timesPerDay}X${e.unitsPerTime} ${Object(o.A)(Object(r.I)(e.form))}`}}};i.c([p.k],v.prototype,"timerInputs",void 0),i.c([p.k],v.prototype,"timeComb",void 0),i.c([p.d],v.prototype,"calcTime",null),i.c([p.d],v.prototype,"otherAppointmentsNumber",null),i.c([p.d],v.prototype,"treatmentOptions",null),i.c([p.d],v.prototype,"canEdit",null),v=i.c([l.a],v)}}]);