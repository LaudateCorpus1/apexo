(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{312:function(e,t,a){"use strict";a.r(t),a.d(t,"CalendarPage",function(){return y});var n=a(1),l=a(7),c=a(3),s=a(9),r=a(5),d=a(2),i=a(8),o=a(294),m=a(297),u=a(291),E=a(0);let y=class extends E.Component{constructor(){super(...arguments),this.filter="",this.appointment=null,this.showAll=!0}componentDidMount(){this.unifyHeight();const e=c.y.currentLocation.split("/")[1];if(!e)return;const t=e.split(/\W/);s.E.selectedYear=Object(r.r)(t[0]),s.E.selectedMonth=Object(r.r)(t[1])-1,s.E.selectedDay=Object(r.r)(t[2])}componentDidUpdate(){this.unifyHeight()}unifyHeight(){if(!document.getElementById("full-day-cols"))return;const e=document.getElementsByClassName("full-day-col");let t=0;for(let a=0;a<e.length;a++){const n=e[a].clientHeight;n>t&&(t=n)}for(let a=0;a<e.length;a++)e[a].style.minHeight=t?t+"px":"auto"}render(){return E.createElement("div",{className:"calendar-component container-fluid"},E.createElement("div",{className:"selector year-selector"},E.createElement(l.m,null,[s.E.currentYear-2,s.E.currentYear-1,s.E.currentYear,s.E.currentYear+1].map(e=>E.createElement(l.c,{key:e,span:6,className:"centered"},E.createElement("a",{onClick:()=>{s.E.selectedYear=e,s.E.selectedMonth=0,s.E.selectedDay=1},className:(s.E.selectedYear===e?"selected":"")+(s.E.currentYear===e?" current":"")},e))))),E.createElement("div",{className:"selector month-selector"},E.createElement(l.m,null,r.c.monthsShort().map((e,t)=>E.createElement(l.c,{key:e,sm:2,xs:4,className:"centered"},E.createElement("a",{onClick:()=>{s.E.selectedMonth=t,s.E.selectedDay=1},className:(s.E.selectedMonth===t?"selected":"")+(s.E.currentMonth===t&&s.E.currentYear===s.E.selectedYear?" current":"")},e))))),E.createElement("div",{className:"selector day-selector"},E.createElement("div",{className:"day-selector-wrapper"},E.createElement("div",null,s.E.selectedMonthDays.map(e=>E.createElement("div",{key:e.dateNum,onClick:()=>{s.E.selectedDay=e.dateNum,setTimeout(()=>{scroll(0,this.findPos(document.getElementById("day_"+e.dateNum)))},0)},className:"day-col"+(s.E.selectedDay===e.dateNum?" selected":"")+(-1===c.C.currentUser.onDutyDays.indexOf(e.weekDay.dayLiteral)?" holiday":"")+(e.weekDay.isWeekend?" weekend":"")},E.createElement("div",{className:"day-name"},Object(c.B)(e.weekDay.dayLiteralShort.substr(0,2).toUpperCase())),E.createElement("a",{className:"day-number info-row"+(e.dateNum===s.E.currentDay&&s.E.currentMonth===s.E.selectedMonth&&s.E.selectedYear===s.E.currentYear?" current":"")},e.dateNum)))),E.createElement("div",null,s.E.selectedMonthDays.map(e=>{const t=s.B.appointmentsForDay(s.E.selectedYear,s.E.selectedMonth+1,e.dateNum,void 0,this.showAll?void 0:c.C.currentUser._id).length;return E.createElement("div",{key:e.dateNum,onClick:()=>{s.E.selectedDay=e.dateNum},className:"day-col"+(s.E.selectedDay===e.dateNum?" selected":"")+(-1===c.C.currentUser.onDutyDays.indexOf(e.weekDay.dayLiteral)?" holiday":"")+(e.weekDay.isWeekend?" weekend":"")},E.createElement("div",{className:"info-row appointments-num num-"+t},t))})))),E.createElement("div",{className:"week-view"},E.createElement("div",{className:"filters"},E.createElement(l.m,null,E.createElement(l.c,{sm:12,md:6,xs:24},E.createElement(o.a,{defaultChecked:this.showAll,onText:Object(c.B)("All appointments"),offText:Object(c.B)("My appointments only"),onChange:(e,t)=>{this.showAll=t}})),E.createElement(l.c,{sm:12,md:18,xs:0,className:"filter"},E.createElement(m.a,{placeholder:Object(c.B)("Type to filter"),onChange:(e,t)=>this.filter=t})))),E.createElement("div",{id:"full-day-cols"},s.E.selectedWeekDays.map(e=>E.createElement("div",{key:e.dateNum,id:"day_"+e.dateNum,className:"full-day-col"+(-1===c.C.currentUser.onDutyDays.indexOf(e.weekDay.dayLiteral)?" holiday":"")+(s.E.selectedDay===e.dateNum?" selected":""),onClick:()=>{s.E.selectedDay=e.dateNum},style:{width:(100/s.E.selectedWeekDays.length).toString()+"%"}},E.createElement("h4",null,E.createElement("b",null,e.dateNum),"   ",E.createElement("span",{className:"day-name"},Object(c.B)(e.weekDay.dayLiteral))),s.B.appointmentsForDay(s.E.selectedYear,s.E.selectedMonth+1,e.dateNum,this.filter,this.showAll?void 0:c.C.currentUser._id).sort((e,t)=>e.date-t.date).map(e=>E.createElement("div",{key:e._id,className:"appointment",onClick:()=>{this.appointment=s.B.list[s.B.getIndexByID(e._id)]}},E.createElement("div",{className:"time"},e.formattedTime),E.createElement("div",{className:"m-b-5"},E.createElement(l.l,{text:e.treatment?e.treatment.type:"",size:1})),E.createElement(s.q,{id:(e.patient||new s.m)._id}),e.operatingStaff.map(e=>E.createElement("div",{key:e._id,className:"m-t-5 fs-11"},E.createElement(u.a,{iconName:"Contact"})," ",e.name)))))))),this.appointment?E.createElement(l.a,{key:"ae",loader:()=>n.b(this,void 0,void 0,function*(){const e=(yield Promise.all([a.e(0),a.e(2)]).then(a.bind(null,303))).AppointmentEditorPanel;return E.createElement(e,{appointment:this.appointment,onDismiss:()=>this.appointment=null,onDelete:()=>this.appointment=null})})}):"")}findPos(e){let t=0;if(e&&e.offsetParent){do{t+=e.offsetTop}while(e=e.offsetParent);return t-70}return 0}};n.c([d.k],y.prototype,"filter",void 0),n.c([d.k],y.prototype,"appointment",void 0),n.c([d.k],y.prototype,"showAll",void 0),y=n.c([i.a],y)}}]);